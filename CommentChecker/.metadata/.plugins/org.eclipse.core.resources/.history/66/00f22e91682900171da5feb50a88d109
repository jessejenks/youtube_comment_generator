import java.io.File;
import java.io.FileNotFoundException;
import java.util.HashMap;
import java.util.Scanner;
import java.util.Set;

public class CSVParser {

	public String fileName;
	public HashMap<String, Integer> wordCount;
	
	
	public CSVParser(String fileName){
		
		this.fileName = fileName;
		this.wordCount = new HashMap<String, Integer>();
		this.parseFile();
		
	}
	
	public void parseFile(){
		
		File csvFile = new File(fileName);
		System.out.println(csvFile.getAbsolutePath());
		Scanner scan = null;
		
		try {
			scan = new Scanner(csvFile);
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		}		
		scan.useDelimiter(",");
		
		while(scan.hasNext()){
			
			// Skip through the first 4 columns
			for(int i = 0; i < 4; i++){
				scan.next();
			}
			
			// Extract comment
			String comment = scan.next();
			
			// Don't care about other contents
			scan.nextLine();
			
			// Parse comment, add to word count
			this.parseComment(comment);
		}
	}
	
	private void parseComment(String comment){
		
		// Split the comment
		String[] data = comment.split("[\\p{Punct}\\s]+");
		
		// Start racking up word counts
		for(int i = 0; i < data.length; i++){
			
			String word = data[i];
			
			// Word count
			if(!wordCount.containsKey(word)){
				wordCount.put(word.toLowerCase(), 1);
			}else{
				wordCount.put(word.toLowerCase(), wordCount.get(word) + 1);
			}			
			
		}
		
	}
	
	public void printWordCount(){
		
		System.out.print("File: ");
		System.out.println(this.fileName);
		System.out.println("==========");
		System.out.println("Words");
		
		Set<String> keys = wordCount.keySet();
		
		for(String word : keys){
			
			System.out.print(word + ": ");
			System.out.println(this.wordCount.get(word));
			
		}
		
	}
}
